---
title: ffmpeg (내가) 자주 사용하는 명령어 모음집
description: 
published: true
date: 2023-10-04T14:15:23.078Z
tags: ffmpeg, tips
editor: markdown
dateCreated: 2023-07-07T08:37:55.719Z
---

## mp4 동영상에서 소리만 추출하여 mp3 로 변경

```bash
ffmpeg -i input.mp4 -vn -acodec libmp3lame -q:a 4 output.mp3
```

만약 오디오 퀄리티를 좀 더 원본에 가깝게 가져가고 싶다면 `-q:a` 옵션을 낮춰가면서 시도해볼 수 있음 (낮을 수록 좋음. 0~9)


## 음원 파일을 특정 이미지 사용한 스틸 이미지 동영상으로 만들기

- 일반적으로 음악에 앨범 커버 씌워서 동영상으로 만들 때 사용

```bash
ffmpeg -loop 1 -i image.jpeg -i "input.mp3" -c:v libx264 -tune stillimage -c:a copy -shortest "output.mp4"
```

- `-loop 1`: 이미지를 무한 반복하여 사용합니다. 즉, 이미지를 동영상으로 변환할 때 한 프레임의 이미지만 사용하더라도 반복 재생됩니다.
- `-i image.jpeg`: 입력으로 사용할 이미지 파일의 경로와 이름을 지정합니다. 예시에서는 "image.jpeg"로 설정되어 있습니다. 즉, image.jpeg 파일이 이미지 입력으로 사용됩니다.
- `-i "input.mp3"`: 입력으로 사용할 오디오 파일의 경로와 이름을 지정합니다. 예시에서는 "input.mp3"로 설정되어 있습니다. 즉, input.mp3 파일이 오디오 입력으로 사용됩니다.
- `-c:v libx264`: 비디오 코덱을 libx264로 설정합니다. libx264는 H.264 비디오 코덱을 사용하여 동영상을 압축합니다.
- `-tune stillimage`: 이미지를 대상으로 최적화된 설정을 사용합니다. 이 설정은 정적인 이미지에 적합합니다.
- `-c:a copy`: 오디오 스트림을 원본과 동일하게 복사합니다. 따라서 오디오는 재인코딩되지 않고 그대로 복사됩니다.
- `-shortest`: 더 짧은 입력 파일(이미지 또는 오디오)에 맞추어 동영상의 길이를 제한합니다.
- `"output.mp4"`: 출력 파일의 경로와 이름을 지정합니다. 예시에서는 "output.mp4"로 설정되어 있습니다. 즉, output.mp4 파일이 결과 동영상으로 생성됩니다.

위 명령어는 image.jpeg 파일과 input.mp3 파일을 결합하여 H.264 비디오 코덱으로 압축된 MP4 동영상 파일인 output.mp4을 생성합니다. 이미지는 반복 재생되며, 오디오는 원본 파일을 그대로 사용합니다. 최종적으로 생성된 동영상은 이미지를 보여주는 동안 배경음악이 재생됩니다.


## 동영상을 반복 재생 시켜서 긴 동영상 만들기

```bash
ffmpeg -stream_loop -1 -i input.mp4 -c:v copy -c:a copy -t 7200 input-2hours.mp4
```

- `-t`: 추출 길이 (seconds, 여기서는 반복 재생으로 생성될 영상의 길이)

## 동영상의 일부분 추출하기

```bash
ffmpeg -ss 889 \
-i "input.mp4" \
-t 60 \
-c copy \
"ouput.mp4"
```

- `ss`: 시작점 (seconds)
- `-t`: 추출 길이 (seconds)
- `-c copy`: 비디오/오디오 코덱 유지

## 동영상 회전

```bash
ffmpeg -i input.mp4 \
-vf "transpose=1" \
-c:a copy \
output.mp4
```

- `-vf "transpose=1"`은 값 `1`과 함께 transpose 필터를 적용하여 동영상을 시계 방향으로 90도 회전합니다. 180도 회전을 위해서는 `2`, 270도 회전을 위해서는 `3`을 사용할 수 있으며, 원래 방향을 유지하려면 `0`을 사용할 수 있습니다.

## 가로 동영상을 세로로 변경하고, 여백을 검은색으로 채움

```bash
ffmpeg -i "input.mp4" \
-vf "pad=w=max(iw\,(ih*9/16)):h=max(ih\,(iw*16/9)):(ow-iw)/2:(oh-ih)/2:black" \
-c:a copy \
"output.mp4"
```

- `-vf`는 비디오 필터를 지정하는 옵션입니다.
- `pad=w=max(iw\,(ih*9/16)):h=max(ih\,(iw*16/9)):(ow-iw)/2:(oh-ih)/2:black`는 입력 영상의 캔버스를 9:16 비율로 변경하고 검은색 (black)으로 여백을 채웁니다.
  - `w=max(iw\,(ih*9/16))`는 캔버스의 가로 너비를 입력 영상의 가로 너비와 세로 너비를 기반으로 계산합니다. `iw`는 입력 영상의 가로 너비를, `ih*9/16`은 9:16 비율의 세로 너비를 의미합니다. `max()` 함수를 사용하여 입력 영상의 가로 너비와 계산된 너비 중 더 큰 값을 선택합니다.
  - `h=max(ih\,(iw*16/9))`는 캔버스의 세로 너비를 입력 영상의 세로 너비와 가로 너비를 기반으로 계산합니다. ih는 입력 영상의 세로 너비를, `iw*16/9`은 `9:16` 비율의 가로 너비를 의미합니다. `max()` 함수를 사용하여 입력 영상의 세로 너비와 계산된 너비 중 더 큰 값을 선택합니다.
  - `(ow-iw)/2:(oh-ih)/2`는 입력 영상의 캔버스를 중앙에 배치합니다. `(ow-iw)/2`는 가로 여백의 크기를 계산하고, `(oh-ih)/2`는 세로 여백의 크기를 계산합니다.
  - `black`은 여백을 검은색으로 채우도록 지정합니다.
-`c:a copy`는 오디오 스트림을 원본과 동일하게 유지하도록 설정합니다.